<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tangu.tcmts.dao.WarehouseMapper">
	<resultMap id="BaseResultMap" type="com.tangu.tcmts.po.WarehouseDO">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="warehouse_name" property="warehouseName"
			jdbcType="VARCHAR" />
		<result column="warehouse_type" property="warehouseType"
			jdbcType="INTEGER" />
		<result column="remark" property="remark" jdbcType="VARCHAR" />
		<result column="use_state" property="useState" jdbcType="BIT" />
		<result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
		<result column="mod_user" property="modUser" jdbcType="INTEGER" />
	</resultMap>

	<select id="listWarehouse" parameterType="com.tangu.tcmts.po.WarehouseDTO"
		resultMap="BaseResultMap">
		SELECT id,warehouse_name,warehouse_type,remark,use_state FROM
		`warehouse`
		<where>
			<if test="warehouseName != null and warehouseName != '' ">
				warehouse_name LIKE CONCAT('%',#{warehouseName},'%')
			</if>
			<if test="warehouseType != null">
				AND warehouse_type=#{warehouseType}
			</if>
			<if test="useState != null">
				AND use_state=#{useState}
			</if>
			<if test="id != null">
				AND id=#{id}
			</if>
		</where>
	</select>
	<update id="updateUseState" parameterType="com.tangu.tcmts.po.WarehouseDTO">
		UPDATE warehouse
		SET
		use_state=#{useState},
		mod_user=#{modUser}
		where id=#{id}
	</update>
	<insert id="addWarehouse" parameterType="com.tangu.tcmts.po.WarehouseDO">
		 <selectKey resultType="java.lang.Integer" keyProperty="id"
			order="AFTER">
			SELECT @@IDENTITY
		</selectKey>
		INSERT INTO `warehouse` (warehouse_name,warehouse_type,remark)
		VALUES(#{warehouseName},#{warehouseType},#{remark})
	</insert>
	<update id="updateWarehouse" parameterType="com.tangu.tcmts.po.WarehouseDO">
		UPDATE warehouse
		SET
		warehouse_name=#{warehouseName},
		warehouse_type=#{warehouseType},
		remark=#{remark},
		mod_user=#{modUser},
		mod_time=NOW()
		where
		id=#{id}
	</update>
	<select id="getWarehouseByName" parameterType="com.tangu.tcmts.po.WarehouseDO" resultType="java.lang.Integer">
		SELECT count(*) FROM warehouse WHERE warehouse_name=#{warehouseName}
		<if test=" id != null ">
			AND id != #{id}
		</if>
	</select>
</mapper>