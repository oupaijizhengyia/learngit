<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tangu.tcmts.dao.PrintPageMapper" >
  <resultMap id="BaseResultMap" type="com.tangu.tcmts.po.PrintPage"></resultMap>
  <select id="selectByPrimaryKey" resultType="com.tangu.tcmts.po.PrintPage" parameterType="java.lang.Integer" >
    select 
    print_page.*,
    sys_lookup.label as bill_type_name,printer_name
    from print_page LEFT JOIN printer ON print_page.printer_id=printer.id,sys_lookup
    where print_page.id = #{id,jdbcType=INTEGER} AND print_page.bill_type=sys_lookup.value and sys_lookup.code="printType"
  </select>
  <select id="getRepeatPageName" resultMap="BaseResultMap" parameterType="com.tangu.tcmts.po.PrintPage">
    SELECT page_name
    FROM print_page
    <where>
      page_name = #{pageName}
      <if test="id != null">
        AND id != #{id}
      </if>
    </where>
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    delete from print_page
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.tangu.tcmts.po.PrintPage">
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into print_page
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="pageName != null">
        page_name,
      </if>
      <if test="pageWidth != null">
        page_width,
      </if>
      <if test="pageHeight != null">
        page_height,
      </if>
      <if test="layoutDirection != null">
        layout_direction,
      </if>
      <if test="colNumber != null">
        col_number,
      </if>
      <if test="rowSpacing != null">
        row_spacing,
      </if>
      <if test="colSpacing != null">
        col_spacing,
      </if>
      <if test="singlePageNumber != null">
        single_page_number,
      </if>
      <if test="billType != null">
        bill_type,
      </if>
      <if test="defaultState != null">
        default_state,
      </if>
      <if test="image != null">
        image,
      </if>
      <if test="imageWidth != null">
        image_width,
      </if>
      <if test="imageHeight != null">
        image_height,
      </if>
      <if test="remark != null">
        remark,
      </if>
      <if test="backgroundImage != null">
        background_image,
      </if>
      <if test="printBackgroundImage != null">
        print_background_image,
      </if>
      <if test="printerId != null">
        printer_id,
      </if>
      <if test="modUser != null">
        mod_user,
      </if>
      <if test="modTime != null">
        mod_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="pageName != null">
        #{pageName,jdbcType=VARCHAR},
      </if>
      <if test="pageWidth != null">
        #{pageWidth,jdbcType=INTEGER},
      </if>
      <if test="pageHeight != null">
        #{pageHeight,jdbcType=INTEGER},
      </if>
      <if test="layoutDirection != null">
        #{layoutDirection,jdbcType=INTEGER},
      </if>
      <if test="colNumber != null">
        #{colNumber,jdbcType=INTEGER},
      </if>
      <if test="rowSpacing != null">
        #{rowSpacing,jdbcType=INTEGER},
      </if>
      <if test="colSpacing != null">
        #{colSpacing,jdbcType=INTEGER},
      </if>
      <if test="singlePageNumber != null">
        #{singlePageNumber,jdbcType=INTEGER},
      </if>
      <if test="billType != null">
        #{billType,jdbcType=VARCHAR},
      </if>
      <if test="defaultState != null">
        #{defaultState,jdbcType=BIT},
      </if>
      <if test="image != null">
        #{image,jdbcType=VARCHAR},
      </if>
      <if test="imageWidth != null">
        #{imageWidth,jdbcType=INTEGER},
      </if>
      <if test="imageHeight != null">
        #{imageHeight,jdbcType=INTEGER},
      </if>
      <if test="remark != null">
        #{remark,jdbcType=VARCHAR},
      </if>
      <if test="backgroundImage != null">
        #{backgroundImage,jdbcType=VARCHAR},
      </if>
      <if test="printBackgroundImage != null">
        #{printBackgroundImage,jdbcType=BIT},
      </if>
      <if test="printerId != null">
        #{printerId,jdbcType=INTEGER},
      </if>
      <if test="modUser != null">
        #{modUser,jdbcType=INTEGER},
      </if>
      <if test="modTime != null">
        #{modTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updatePrintPage" parameterType="com.tangu.tcmts.po.PrintPage" >
    update print_page
    <set >
      <if test="pageName != null" >
        page_name = #{pageName,jdbcType=VARCHAR},
      </if>
      <if test="pageWidth != null" >
        page_width = #{pageWidth,jdbcType=INTEGER},
      </if>
      <if test="pageHeight != null" >
        page_height = #{pageHeight,jdbcType=INTEGER},
      </if>
      <if test="layoutDirection != null" >
        layout_direction = #{layoutDirection,jdbcType=INTEGER},
      </if>
      <if test="colNumber != null" >
        col_number = #{colNumber,jdbcType=INTEGER},
      </if>
      <if test="rowSpacing != null" >
        row_spacing = #{rowSpacing,jdbcType=INTEGER},
      </if>
      <if test="colSpacing != null" >
        col_spacing = #{colSpacing,jdbcType=INTEGER},
      </if>
      <if test="singlePageNumber != null" >
        single_page_number = #{singlePageNumber,jdbcType=INTEGER},
      </if>
      <if test="billType!= null" >
        bill_type= #{billType,jdbcType=VARCHAR},
      </if>
      <if test="defaultState != null" >
        default_state = #{defaultState,jdbcType=BIT},
      </if>
      <if test="image != null" >
        image = #{image,jdbcType=VARCHAR},
      </if>
      <if test="imageWidth != null" >
        image_width = #{imageWidth,jdbcType=INTEGER},
      </if>
      <if test="imageHeight != null" >
        image_height = #{imageHeight,jdbcType=INTEGER},
      </if>
      <if test="remark != null" >
        remark = #{remark,jdbcType=VARCHAR},
      </if>
      <if test="backgroundImage != null" >
        background_image = #{backgroundImage,jdbcType=VARCHAR},
      </if>
      <if test="printBackgroundImage != null" >
        print_background_image = #{printBackgroundImage,jdbcType=BIT},
      </if>
      <if test="printerId != null" >
        printer_id = #{printerId,jdbcType=INTEGER},
      </if>
      <if test="modUser != null" >
        mod_user = #{modUser,jdbcType=INTEGER},
      </if>
      <if test="modTime != null" >
        mod_time = #{modTime},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.tangu.tcmts.po.PrintPage" >
    update print_page
    set page_name = #{pageName,jdbcType=VARCHAR},
      page_width = #{pageWidth,jdbcType=INTEGER},
      page_height = #{pageHeight,jdbcType=INTEGER},
      layout_direction = #{layoutDirection,jdbcType=INTEGER},
      col_number = #{colNumber,jdbcType=INTEGER},
      row_spacing = #{rowSpacing,jdbcType=INTEGER},
      col_spacing = #{colSpacing,jdbcType=INTEGER},
      single_page_number = #{singlePageNumber,jdbcType=INTEGER},
      bill_type = #{billType,jdbcType=VARCHAR},
      default_state = #{defaultState,jdbcType=BIT},
      image = #{image,jdbcType=VARCHAR},
      image_width = #{imageWidth,jdbcType=INTEGER},
      image_height = #{imageHeight,jdbcType=INTEGER},
      remark = #{remark,jdbcType=VARCHAR},
      background_image = #{backgroundImage,jdbcType=VARCHAR},
      printer_id = #{printerId,jdbcType=INTEGER},
      mod_user = #{modUser,jdbcType=INTEGER},
      mod_time =now()
    where id = #{id,jdbcType=INTEGER}
  </update>


  <select id="listPrintPage"  parameterType="com.tangu.tcmts.po.PrintPage" resultType="com.tangu.tcmts.po.PrintPage">
    select
    print_page.*,
    sys_lookup.label as bill_type_name,printer_name
    from print_page LEFT JOIN printer ON print_page.printer_id=printer.id,sys_lookup
    where print_page.bill_type=sys_lookup.value and sys_lookup.code="printType"
      <if test="pageName!=null and pageName!=''">
        AND page_name like CONCAT('%',#{pageName},'%')
      </if>
      <if test="billType != null and billType!=''">
        AND bill_type=#{billType}
      </if>
    ORDER BY create_time DESC
  </select>
  <resultMap id="printPageResultMap" type="com.tangu.tcmts.po.PrintPage" >
  </resultMap>
  <select id="listPrintPageByTypes" parameterType="java.util.Map" resultMap="printPageResultMap">
    SELECT *
    FROM print_page
    WHERE 
    <if test="ids!=null">
    	id IN(
	    	<foreach collection="ids" item="item" index="index" separator=",">
	    		#{item}
	    	</foreach>
    	)
    </if> 
    <if test="typeIds!=null">
    	bill_type IN(
	    	<foreach collection="typeIds" item="item" index="index" separator=",">
	    		#{item}
	    	</foreach>
    	)
    </if>
  </select>	
</mapper>